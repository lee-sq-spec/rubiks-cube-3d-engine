<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>Rubik Cube 3D Engine</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<style>
html,body{
  margin:0;
  width:100%;
  height:100%;
  overflow:hidden;
  background:#000;
  font-family:system-ui;
  color:#fff;
}

#ui{
  position:absolute;
  inset:0;
  display:flex;
  flex-direction:column;
}

#home{
  flex:1;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  gap:16px;
}

button{
  padding:14px 22px;
  font-size:1rem;
  border-radius:12px;
  border:none;
  background:linear-gradient(135deg,#ff4d4d,#ffcc00);
  font-weight:700;
}

select{
  padding:8px;
  border-radius:8px;
}

#game{
  display:none;
  flex:1;
}

#topbar{
  height:56px;
  background:rgba(0,0,0,.6);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 12px;
}

#scene{
  width:100%;
  height:calc(100% - 56px);
}
</style>
</head>

<body>
<div id="ui">

  <div id="home">
    <h1>Rubik Cube</h1>

    <select id="size">
      <option value="3">3×3</option>
      <option value="4">4×4</option>
      <option value="5">5×5</option>
      <option value="6">6×6</option>
      <option value="7">7×7</option>
      <option value="8">8×8</option>
      <option value="9">9×9</option>
      <option value="10">10×10</option>
      <option value="11">11×11</option>
      <option value="12">12×12</option>
    </select>

    <button onclick="start('classic')">Classic</button>
    <button onclick="start('timer')">Timer</button>
    <button onclick="start('assist')">Assist</button>
  </div>

  <div id="game">
    <div id="topbar">
      <span id="mode"></span>
      <button onclick="back()">Home</button>
    </div>
    <div id="scene"></div>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160/build/three.min.js"></script>

<script>
/* ========= 全局 ========= */
let scene,camera,renderer,cubeGroup;
let size=3,mode="classic";

/* ========= 启动 ========= */
function start(m){
  mode=m;
  size=parseInt(sizeEl.value);
  home.style.display="none";
  game.style.display="block";
  modeEl.textContent=mode.toUpperCase();
  init3D();
}

function back(){
  location.reload();
}

/* ========= Three.js ========= */
function init3D(){
  scene=new THREE.Scene();
  camera=new THREE.PerspectiveCamera(45,innerWidth/(innerHeight-56),0.1,1000);
  camera.position.set(size*2,size*2,size*2);
  camera.lookAt(0,0,0);

  renderer=new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(innerWidth,innerHeight-56);
  sceneEl.appendChild(renderer.domElement);

  scene.add(new THREE.AmbientLight(0xffffff,0.9));
  let d=new THREE.DirectionalLight(0xffffff,0.6);
  d.position.set(10,20,10);
  scene.add(d);

  buildCube(size);
  animate();
}

/* ========= 魔方构建 ========= */
function buildCube(N){
  cubeGroup=new THREE.Group();
  const colors=[0xff0000,0x00ff00,0x0000ff,0xffff00,0xff8000,0xffffff];

  for(let x=0;x<N;x++)
  for(let y=0;y<N;y++)
  for(let z=0;z<N;z++){
    let mats=colors.map(c=>new THREE.MeshLambertMaterial({color:c}));
    let geo=new THREE.BoxGeometry(.95,.95,.95);
    let cubie=new THREE.Mesh(geo,mats);
    cubie.position.set(x-(N-1)/2,y-(N-1)/2,z-(N-1)/2);
    cubeGroup.add(cubie);
  }

  scene.add(cubeGroup);
}

/* ========= 动画 ========= */
function animate(){
  requestAnimationFrame(animate);
  cubeGroup.rotation.y+=0.002;
  renderer.render(scene,camera);
}

/* ========= DOM ========= */
const home=document.getElementById("home");
const game=document.getElementById("game");
const sizeEl=document.getElementById("size");
const modeEl=document.getElementById("mode");
const sceneEl=document.getElementById("scene");
</script>
</body>
</html>
